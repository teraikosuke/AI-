---
description: ユーザーの要求から新しいルールファイル（.agent/rules/*.md）を対話的に作成する。
---
# ルール作成 (Create Rule)

## Step 1: 要求のヒアリング
ユーザーから以下の情報を収集せよ：

1. **何を制約したいか**: どのような行動・出力を制御したいか
2. **いつ適用するか**: 常に？特定の状況で？特定のファイルに対して？
3. **禁止事項はあるか**: 絶対にやってはいけないことは何か
4. **例外条件はあるか**: ルールを適用しないケースはあるか

情報が不足している場合は、具体的な質問で補完せよ。

## Step 2: トリガータイプの決定
収集した情報から最適なトリガーを判断せよ：

| ユーザーの意図 | 推奨トリガー |
|----------------|--------------|
| 「プロジェクト全体で常に〜」 | `always_on` |
| 「〜するときは」「〜の場合は」 | `model_decision` |
| 「〜ファイルに対しては」 | `glob` |
| 「明示的に指定したときだけ」 | `manual` |

選択したトリガーとその理由をユーザーに説明せよ。

## Step 3: ルール構造の設計
以下の構造でルールを設計せよ：

```markdown
---
trigger: <決定したトリガー>
description: <model_decisionの場合は意図を捉えるキーワードを含める>
slug: <ファイル名と同一>
---
# <ルール名>

## 基本方針
<ルールの目的と基本的な考え方>

## 必須事項 (MUST)
<必ず守るべきこと>

## 禁止事項 (MUST NOT)
<絶対にやってはいけないこと>

## 推奨事項 (SHOULD)
<できれば守るべきこと>

## 例外条件
<ルールを適用しないケース>
```

設計案をユーザーに提示し、フィードバックを求めよ。

## Step 4: ファイル名の決定
以下のルールに従ってファイル名を決定せよ：

- 形式: `<カテゴリ>-<具体的な内容>.md`
- ケバブケース（小文字、ハイフン区切り）
- 簡潔だが内容がわかる名前

例:
- `security-api-keys.md`
- `typescript-strict-mode.md`
- `react-hooks-usage.md`

## Step 5: 既存ルールとの整合性チェック
`.agent/rules/` 配下の既存ルールを確認せよ：

1. **重複チェック**: 同様の制約が既に存在しないか
2. **矛盾チェック**: 既存ルールと矛盾する内容がないか
3. **参照可能性**: 既存ルールを `@` 参照で再利用できないか

問題がある場合はユーザーに報告し、対処方針を相談せよ。

## Step 6: ルールファイルの生成
設計に基づいてルールファイルを作成せよ。

保存先: `ZG_PROJECT/<プロジェクト名>/.agent/rules/<決定したファイル名>`

ファイル名には番号プレフィックスを付与すること：
- `00-` ～ `09-`: 定義・基盤ルール
- `10-` ～ `19-`: 基本ルール
- `20-` ～ `29-`: 言語/フレームワーク固有
- `30-` ～ : ドメイン固有

## Step 7: 検証
作成したルールの検証を行え：

1. **YAML構文チェック**: フロントマターが正しくパースできるか
2. **内容の確認**: ユーザーの要求を満たしているか
3. **可読性**: 構造が明確で理解しやすいか

作成したルールの全文をユーザーに提示し、最終確認を求めよ。

## Step 8: 完了報告
以下の情報をユーザーに報告せよ：

- 作成したファイルのパス
- 選択したトリガータイプ
- ルールが適用される条件の説明
- 関連する既存ルール（あれば）
