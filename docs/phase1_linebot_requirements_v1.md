# フェーズ1（LINEボット） 要件定義書 v1

## 1. 概要
- 目的: 研修の予習・復習支援、およびフェーズ2高度化に向けた利用データ（質問/回答ログ等）の収集。
- 対象: 九州電力 受講者 約25名（トライアル）。
- 参照: `phase1_linebot_brief_estimate_v1.md`（本ドキュメントは同見積の内容を要件化したもの）。

## 2. スコープ（フェーズ1）
- LINEボット（テキストQA/RAG）
- 運用マニュアル（受講者向け/事務局向け 簡易版）
- 使い方動画（1本）

除外（フェーズ2以降で検討）
- 音声入力、画像/資料アップロード
- 専用ダッシュボード（リアルタイム可視化・通知・CSV出力）
- Webアプリの詳細UI/管理機能
- 個別高度チューニング（ユーザー別最適化 等）

## 3. 機能要件
### 3.1 チャットQA（必須）
- 入力: LINEテキスト（日本語）。
- 応答: 日本語テキスト。RAGによりナレッジ内から回答生成。
- ナレッジ境界: 提供範囲内の講義/書籍等に限定。
- 履歴参照: 直近5往復分まで（過去発話コンテキストの参照上限）。
- 回答不可時（範囲外質問）: 書籍/講義に関係のない質問（例: 「あなたの誕生日はいつですか？」等）は「範囲外」と判定し、ユーモアを交えて回答できない旨を伝える。
  - 返信例（案）: 「そのご質問は私の専門外です。代わりに◯◯の章についてならお手伝いできます！」/「誕生日はひみつです……代わりに次回講義日ならお答えできます。」
  - 口調: 丁寧かつ軽いユーモア。攻撃的・揶揄・政治/宗教・不適切な内容は不可。
  - ガードレール: 個人情報の開示要求や機密に関わる問いには応じない。必要に応じて適切な誘導（関連トピックや次のアクション提案）。
  - ログ: 範囲外判定時は `reason=oos` を付与してログ化（集計/改善用）。

### 3.2 ナレッジ更新
- 頻度: 月1回。
- 対応: 追加/修正データの受領→前処理→インデックス更新→検証→反映。

### 3.3 ログ取得/閲覧
- 取得項目: 質問テキスト、回答テキスト、日時、ユーザー識別子（ハッシュ化または代替ID）。
- 閲覧: 当面はLINE管理画面にて基本的なログ閲覧（専用ダッシュボードは非対象）。

### 3.4 運用マニュアル/使い方動画
- マニュアル: 初期セットアップ/利用手順/FAQ/問い合わせ先。
- 動画: 1〜3分の画面操作デモ。

## 4. 非機能要件
- 可用性: トライアル期間中 平日9:00-20:00を主対象（24/7はベストエフォート）。
- 性能：未定（詳細要件は無し目標は30秒以内）
- 同時利用者数: 最大25名（設計上限）
- セキュリティ:
  - LINEチャネル秘密情報・APIキーの安全管理（Secret Manager）。
  - 個人識別情報の最小化/ハッシュ化（現時点では必要無し）。
  - ログのアクセス制御/権限管理（現時点では必要無し）。
- 監査/記録: 変更履歴（ナレッジ更新、設定変更）を記録。
- 保守性: IaC/設定のコード化（可能な範囲）。

## 5. データ/ナレッジ設計
- 入力データ: 書籍、講義資料、補足Q&A。
- 前処理: PDF→テキスト抽出、分割、メタ情報付与（章/テーマ/日付）。
- ベクタ格納: Embeddings（モデルは提案に従う）。
- 禁止事項: 著作権侵害/機密データの無断取り込みを禁止。提供素材に限定。

## 6. 外部インターフェース
- ユーザーIF: LINE公式アカウント（トーク）。
- 管理IF: LINE Official Account Manager での簡易ログ閲覧。
- 将来拡張（非スコープ）: 管理ダッシュボード（KPI/可視化/CSV出力/通知）。

## 7. 環境/構成（想定）
- クラウド: GCP（コスト/運用方針により選定）。
- 構成例:
  - Messaging API（LINE）
  - App/API（Functions/Container）
  - Vector DB（例: Cloud-hosted VectorStore）
  - DB（postgrase）
  - Object Storage（学習素材）
  - Secret Manager（キー類）

## 8. スケジュール（目安）
- 10月: 仕様確定（本書レビュー/承認）
- 10月旬開発（ボット/ナレッジ構築/マニュアル/動画）
- 11月中旬: トライアル開始（約25名）

## 9. 受入基準（UAT）目標
- チャットQA: テスト用代表質問50件に対し、意図一致率≥80%（ナレッジ内質問）。（書籍のどの部分に回答が書いているか？/どう回答するかの例）10/15に欲しい。
- 回答不可時: 定型メッセージの出し分けが正しく機能。
- ナレッジ更新: 月次更新手順で反映と再検索が確認できる。
- 運用: マニュアル/動画で初見ユーザーが操作可能。

## 10. 運用/保守
- 月次: ナレッジ追加、応答調整、簡易レポート、軽微改善、基本インフラ運用。
- 1次問合せはセルム（技術要件などに関してはSakura Rinからセルムに回答）
- 保存期間: ログの保持期間は2月末まで。

## 11. 前提/制約
- LINE公式アカウントの開設: SakuraRin側。
- データ提供: 月1回（講義/書籍追加・修正） セルム側。
- 個人情報の扱い: 収集最小化、外部学習無効/オプトアウト前提のAPI利用。
- 開発目的：他の講師への流用も検討中であるため汎用性も求められる。

## 12. 見積/費用（抜粋・税抜）
- 初期開発: 1,200,000円。
- ランニング（12〜2月）: 150,000円/月（ナレッジ追加/調整/簡易レポート/軽微改善/基本運用コスト含む）。
- アドオン（講義内容追加 大規模・機能拡張）: 別途見積。

## 13. 変更管理
- 仕様追加/変更は別途見積。スケジュール/受入基準を必要に応じ更新。

## 14. リスク/対応
- ナレッジの粒度不足→Q&A不足: 収録強化（受講者質問/講師回答ペア収集）。
- LLM応答時間のばらつき: キャッシュ/プロンプト最適化/小規模モデル併用。
- 個人情報/権利: 提供素材限定・第三者著作物取り込み不可。

## 15. 添付/参照
- `phase1_linebot_brief_estimate_v1.md`
- `株式会社セルム御中_お見積り・スケジュール資料.pdf`


