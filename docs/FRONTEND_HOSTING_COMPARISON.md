# 本番運用に向けた検討資料

**作成日**: 2026-02-06  
**対象**: Agent Key ATS フロントエンド  
**目的**: チーム検討用資料

---

## 📋 目次

1. [現在のシステム構成](#現在のシステム構成)
2. [フロントエンドホスティング比較](#フロントエンドホスティング比較)
3. [本番リリース前の確認事項](#本番リリース前の確認事項)
4. [FAQ](#faq)

---

## 現在のシステム構成

### サーバーレスアーキテクチャ（EC2不要）

```
┌─────────────────────────────────────────────────────────┐
│                    サーバー管理不要                      │
├─────────────────────────────────────────────────────────┤
│  ┌───────────────┐      ┌───────────────┐              │
│  │ フロントエンド │      │ バックエンド   │              │
│  │ (静的ファイル) │      │ (Lambda)      │              │
│  │               │ ───→ │ API Gateway   │              │
│  │ ※ホスティング │ HTTPS│ + Lambda      │              │
│  │   選定中      │      └───────┬───────┘              │
│  └───────────────┘              │                       │
│                                 ▼                       │
│                         ┌───────────────┐              │
│                         │ RDS           │              │
│                         │ (PostgreSQL)  │              │
│                         └───────────────┘              │
└─────────────────────────────────────────────────────────┘
```

### EC2が不要な理由

| コンポーネント | 使用サービス | サーバー管理 |
|---------------|-------------|-------------|
| フロントエンド | Amplify or Cloudflare | 不要 |
| API | API Gateway + Lambda | 不要 |
| データベース | RDS (PostgreSQL) | 不要（マネージド） |

---

## フロントエンドホスティング比較

### 候補サービス一覧

| サービス | 料金 | CDN速度 | AWS統合 | おすすめ |
|----------|------|---------|---------|---------|
| **AWS Amplify** | 従量課金 | 高速 | ◎ 最適 | 本格運用向け |
| **Cloudflare Pages** | 完全無料 | 超高速 | ○ API経由 | 初期検証向け |
| Vercel | 無料枠あり | 高速 | ○ | 代替案 |
| Netlify | 無料枠あり | 高速 | ○ | 代替案 |
| S3 + CloudFront | 従量課金 | 高速 | ◎ | 設定が複雑 |

### 主要候補: AWS Amplify vs Cloudflare Pages

| 項目 | AWS Amplify | Cloudflare Pages |
|------|-------------|------------------|
| **料金** | 従量課金（無料枠あり） | 完全無料（帯域無制限） |
| **無料枠詳細** | 1,000ビルド/月、15GB配信/月 | 500ビルド/月、帯域無制限 |
| **CDN速度** | 高速 | 超高速（世界最速級） |
| **GitHub連携** | ◎ | ◎ |
| **カスタムドメイン** | 無料SSL | 無料SSL |
| **プレビュー機能** | ◎（PR毎に自動生成） | ◎（PR毎に自動生成） |
| **ロールバック** | ワンクリック | ワンクリック |

### AWS統合について

**重要**: どのホスティングを選んでも、APIとの通信方法は変わりません。

```
フロントエンド ──(HTTPS)──→ API Gateway ──→ Lambda ──→ RDS
```

**変わるのは運用面のみ**:

| 項目 | AWS Amplify | Cloudflare Pages |
|------|-------------|------------------|
| ダッシュボード | AWSのみ | AWS + Cloudflare |
| ログ確認 | CloudWatch統一 | 2箇所で別々 |
| 請求書 | 1つ | 2つ |
| アラート設定 | CloudWatch統一 | 別々に設定 |

### 移行の容易さ

**どちらを選んでも、後から変更可能**
- 移行作業時間: 約10分
- データ移行: 不要（静的ファイルのみ）
- ダウンタイム: DNS切り替え時のみ

### 推奨シナリオ

| 運用規模 | 推奨サービス | 理由 |
|---------|-------------|------|
| 初期検証〜100人 | Cloudflare Pages | 無料で十分 |
| 100人〜本格運用 | AWS Amplify | AWS統一管理のメリット大 |

### 提案オプション

**オプションA**: 最初からAWS Amplifyで構築
- ✅ AWS統一、移行不要
- ⚠️ 初期から従量課金

**オプションB**: Cloudflare Pagesで開始 → 本格運用時にAmplifyへ移行
- ✅ 初期コスト0、検証しやすい
- ⚠️ 移行作業が発生

---

## 本番リリース前の確認事項

### ✅ 完了済み

| 項目 | 状態 |
|------|------|
| セキュリティ修正（.env除外） | ✅ 完了 |
| Git履歴クリーンアップ | ✅ 完了 |
| Amplify CLI インストール | ✅ 完了 |
| amplify.yml 作成 | ✅ 完了 |

### 🔄 検討中

| 項目 | 状態 |
|------|------|
| フロントエンドホスティング選定 | 🔄 チーム検討中 |

### ❓ 今後決める必要があること

| 項目 | 説明 | 重要度 |
|------|------|--------|
| 本番用APIステージ | 現在 `/dev` → `/prod` 作成 | ⭐⭐⭐ |
| シークレット管理 | Secrets Managerへ移行 | ⭐⭐⭐ |
| カスタムドメイン | `app.example.com` 等 | ⭐⭐ |
| 監視・アラート | エラー通知設定 | ⭐⭐ |
| バックアップ | RDS自動バックアップ設定 | ⭐⭐ |

---

## FAQ

### Q: EC2でサーバーを建てる必要はありますか？

**A: 不要です。** 現在の構成は完全サーバーレスです。

| 従来のEC2構成 | 現在のサーバーレス構成 |
|--------------|---------------------|
| サーバー管理必要 | 管理不要 |
| 常時課金 | 使った分だけ課金 |
| 手動スケーリング | 自動スケーリング |
| 自分で障害対応 | AWS/Cloudflareが対応 |

### Q: ホスティングを後から変更できますか？

**A: はい、簡単に変更できます。** 静的ファイルをホストするだけなので、移行は約10分で完了します。

### Q: AWS統一にするメリットは？

**A: 運用の一元化です。** 技術的な通信経路は変わりませんが、以下が統一されます:
- ダッシュボード（1つでOK）
- ログ確認（CloudWatch統一）
- 請求管理（1つのアカウント）
- アラート設定（CloudWatch統一）

### Q: たくさんの人が使う場合、どちらがいい？

**A: AWS Amplifyを推奨します。** 理由:
- バックエンドと同じAWS内で統一管理
- CloudWatchで監視・アラートを一元化
- 請求を1つのAWSアカウントにまとめられる

ただし、**小規模（〜100人）ならCloudflare Pagesでも十分**です。

---

## 🔗 参考リンク

- [AWS Amplify Hosting](https://aws.amazon.com/jp/amplify/hosting/)
- [Cloudflare Pages](https://pages.cloudflare.com/)
- [Cloudflare Pages 料金](https://www.cloudflare.com/ja-jp/plans/developer-platform/)

---

**作成者**: 開発チーム
